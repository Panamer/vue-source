{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/utils.js","../src/observer/dep.js","../src/observer/index.js","../src/state.js","../src/compiler/parser.js","../src/compiler/generator.js","../src/compiler/index.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/create-element.js","../src/render.js","../src/index.js"],"sourcesContent":["/**\n * å¯¹æ•°ç»„çš„7ä¸ªæ–¹æ³•åšå‡½æ•°åŠ«æŒ, ä¸ºä»€ä¹ˆæ˜¯è¿™7ä¸ªå‘¢? å› ä¸ºåªæœ‰ä»–ä»¬èƒ½æ”¹å˜æ•°ç»„æœ¬èº«\n * âš ï¸ åœ¨å®é™…åº”ç”¨ä¸­ æ“ä½œæ•°ç»„ç´¢å¼•æ”¹å˜æ•°ç»„ vueæ˜¯æ£€æµ‹ä¸åˆ°çš„  list[0] = 100 âŒ\n * åŸç†: å¤åˆ¶æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³• å¯¹å…¶ä¸­7ä¸ªåšå‡½æ•°åŠ«æŒ AOP\n * å…ˆæ‰§è¡Œè‡ªå®šä¹‰æ–¹æ³• å†è§¦å‘åŸå‹ä¸Šçš„æ–¹æ³• apply \n */\n\nlet oldArrayMethods = Array.prototype;  // è·å–æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•\n\n// åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡, æ ¹æ®åŸå‹é“¾å¯ä»¥æ‰¾åˆ°æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•, è€Œä¸”æ‹“å±•æ–¹æ³•æ—¶ ä¸ä¼šå½±å“åŸæ•°ç»„çš„åŸå‹æ–¹æ³•\nexport let arrayMethods = Object.create(oldArrayMethods)\n\nlet methods = [\n    'push',\n    'pop',\n    'unshift',\n    'shift',\n    'splice',\n    'sort',\n    'reserve'\n]\n\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        const ob = this.__ob__\n        let result = oldArrayMethods[method].apply(this, args)\n        let inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n        inserted && ob.observeArray(inserted)\n        console.log('æ•°ç»„è¢«è§‚æµ‹äº†', inserted);\n        return result;\n    }\n})\n/**\n * ä¸ºä»€ä¹ˆ7ä¸ªæ–¹æ³• åªå¯¹ä¸‰ä¸ªåšäº†å¤„ç†å‘¢?\n * å› ä¸º pushã€unshiftã€splice  å¯ä»¥æ–°å¢å±æ€§. å…¶ä»–å‡ ä¸ªä¸èƒ½æ–°å¢\n * åšå“åº”å¼å¤„ç†çš„ç›®æ ‡æ˜¯å¯¹æ‰€æœ‰æ•°æ®è§‚æµ‹, æ‰€ä»¥ä¸æ˜¯æ–°å¢çš„æ•°æ® ä¸ç”¨å¤„ç†.è™½ç„¶å…¶ä»–çš„æ–¹æ³•ä¹Ÿèƒ½è®©æ•°ç»„æ”¹å˜\n * æ³¨æ„: è¿™ä¸€æ­¥åªåšè§‚æµ‹, ä½¿é¡µé¢æ›´æ–°çš„æ˜¯  è§¦å‘ä¾èµ– ä¸è¦æ··æ·†.\n * è§‚æµ‹å’Œé¡µé¢æ›´æ–°æ²¡æœ‰ç›´æ¥å…³ç³»,è§‚æµ‹æ˜¯ä¸ºæ”¶é›†ã€è§¦å‘ä¾èµ–åšé“ºå«\n */","// æ­¤å¤„æ”¾æ‰€æœ‰çš„å·¥å…·æ–¹æ³•\n\n\nexport function isObject(obj) {\n    return typeof obj === 'object' && obj !== null\n}\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n    'mounted',\n    'beforeUpdate',\n    'updated'\n]\nlet strats = {};\nfunction mergeHook(parentVal,childVal){ // []\n    if(childVal){ // å¦‚æœ å­©å­æœ‰å€¼ \n        if(parentVal){ // çˆ¶äº²æœ‰å€¼ å°±ç›´æ¥æ‹¼æ¥\n            return parentVal.concat(childVal)\n        }else{ // å¦‚æœå­©å­æœ‰å€¼çˆ¶äº²æ²¡å€¼ å°±å°†å­©å­åŒ…è£…æˆæ•°ç»„\n            return [childVal] // Vue.options.beforeCreate = [childVal]\n        }\n    }else{\n        return parentVal; // ç›´æ¥è¿”å›çˆ¶äº²ï¼Œå› ä¸ºæ²¡æœ‰å­©å­  \n    }\n}\nLIFECYCLE_HOOKS.forEach(hook=>{\n    strats[hook] = mergeHook\n})\nexport function mergeOptions(parent,child){ // {...parent,...child}  {a:1.b:2}  {a:{a:{b:2}}}\n    const options = {}\n    // å¦‚æœçˆ¶äº²å’Œå„¿å­é‡Œéƒ½æœ‰ä¸€ä¸ªå±æ€§ è¿™ä¸ªå±æ€§ä¸å†²çª \n    for(let key in parent){ // å¤„ç†çˆ¶äº²çš„æ‰€æœ‰å±æ€§\n        mergeField(key);\n    }\n    for(let key in child){ // å¤„ç†å„¿å­çš„æ‰€æœ‰å±æ€§ï¼Œå¦‚æœçˆ¶äº²æœ‰çš„å€¼ åœ¨ç¬¬ä¸€ä¸ªå¾ªç¯ä¸­å°±å·²ç»å¤„ç†äº†\n        if(!parent.hasOwnProperty(key)){\n            mergeField(key);\n        }\n    }\n    function mergeField(key){\n        // ä¸¤ä¸ªç»„ä»¶é—´ dataæ˜¯å‡½æ•° \n\n        // å†™ä»£ç æ—¶å¾ˆå¿Œè®³ å„ç§if else if else \n\n        // ç­–ç•¥æ¨¡å¼ æ ¹æ®ä¸åŒçš„å±æ€§ è°ƒç”¨ä¸åŒçš„ç­–ç•¥  \n        if(strats[key]){\n            // è¿™é‡Œå°±åŒ…å«äº† mergeHookçš„é€»è¾‘\n            options[key] = strats[key](parent[key],child[key])\n        }else if(isObject(parent[key]) && isObject(child[key])){\n            options[key] = Object.assign(parent[key],child[key])\n        }else{\n            if(child[key] == null){\n                options[key] = parent[key];\n            }else{\n                options[key] = child[key]; // ç”¨å„¿å­çš„å€¼ ç›´æ¥è¦†ç›–æ‰ çˆ¶äº²çš„å€¼\n            }\n        }\n    } // é¢è¯•æ—¶ ç»å¸¸ä¼šæåˆ°å¯¹è±¡é—´çš„åˆå¹¶\n    return options\n}\n","// æ¯ä¸ªdepä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„id å’Œwatcherä¸€æ ·\n// depå’Œwatcheræ˜¯ å¤šå¯¹å¤šçš„å…³ç³» \n// æ¯ä¸ªkeyå¯¹åº”ä¸€ä¸ªdep ä¸€ä¸ªdepå¯èƒ½å­˜ç€å¤šä¸ªwatcher ä¸€ä¸ªwatcherä¹Ÿå¯èƒ½è¢«å¤šä¸ªå±æ€§æ‰€ä¾èµ–\nlet id = 0;\nclass Dep{\n    constructor(){\n        this.id = id++;\n        this.subs = []\n    }\n    // å¯¹è±¡çš„å±æ€§è¢«è®¿é—®  ä¼šæ‰§è¡Œ new Dep ç„¶å dep.depend  è¿™ä¸ªæ—¶å€™Dep.targetä¸Šå·²ç»æœ‰å®ä¾‹äº†\n    // è¡¨é¢ä¸Šæ˜¯è°ƒç”¨äº†depçš„æ–¹æ³•  å…¶å®æ˜¯åœ¨æ“ä½œ watcher \n    // è®©watcherè®°å¿†dep  depè®°å¿†watcher åŒå‘è®°å¿†\n    // å…ˆæ˜¯watcherå­˜dep  å†æ˜¯è°ƒç”¨depçš„addSubæ–¹æ³• å­˜watcher  è€Œä¸”æœ‰å»é‡åœ¨é‡Œé¢ ç§’\n    depend(){\n        Dep.target.addDep(this)\n    }\n    addSub(watcher){\n        this.subs.push(watcher)\n    }\n}\n// åˆå§‹åŒ–æ˜¯null\nDep.target = null;\n\nconst stack = [];\n// æŠŠwatcherå­˜å‚¨åˆ°å…¨å±€\nexport function pushTarget(watcher){\n    Dep.target = watcher\n    stack.push(watcher)\n}\n// åˆ é™¤watcher\nexport function popTarget(){\n    stack.pop()\n    Dep.target = stack[stack.length - 1]\n}\n\nexport default Dep;","import { arrayMethods } from \"./array\";\nimport {isObject} from '../utils.js'\nimport Dep from \"./dep\";\n\n/**\n * ä¸ºä»€ä¹ˆvueç”¨function è¿™é‡Œç”¨class? \n * å› ä¸º Functionæ„é€ å‡½æ•°æ–¹ä¾¿æ‰©å±•åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•, è¿™é‡Œä¸éœ€è¦\n */\nclass Observe {\n    constructor(data) {\n        /**\n         * 1ã€æ·»åŠ ä¸€ä¸ª__ob__å“åº”å¼æ ‡ç¤º,ä»£è¡¨dataå·²ç»è¢«è§‚æµ‹è¿‡, å¯¹è±¡æ•°ç»„éƒ½æœ‰\n         * 2ã€data.__ob__  = this\n         * åœ¨æ•°æ®ä¸Šå°±å¯ä»¥è·å–åˆ°obå±æ€§, æŒ‡ä»£çš„æ˜¯ observeå®ä¾‹\n         */\n        Object.defineProperty(data, '__ob__', {\n            enumerable: false,\n            configurable: false,\n            value: this\n        })\n        /**\n         * å› ä¸ºå®é™…å¼€å‘ä¸­é€šè¿‡ç´¢å¼•æ“ä½œæ•°ç»„çš„æƒ…å†µå¹¶ä¸å¤š, å¦‚æœè¿™é‡Œé€šè¿‡æ‹¦æˆªæ•°ç»„çš„ç´¢å¼• åšå“åº”å¼å¤ªæµªè´¹æ€§èƒ½\n         * æ‰€ä»¥ vueé‡‡ç”¨ å‡½æ•°åŠ«æŒçš„æ–¹æ³• é‡å†™äº† 7ä¸ªèƒ½æ”¹å˜æ•°ç»„æœ¬èº«çš„æ–¹æ³•\n         * è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯ å¯¹è±¡ or æ•°ç»„\n         * åˆ©ç”¨åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾çš„ç‰¹æ€§,ä½¿å¾—æ•°ç»„æ”¹å˜çš„æ–¹æ³•ä»arrayMethodsä¸­å–åˆ°\n         */\n        if (Array.isArray(data)) {\n            data.__proto__ = arrayMethods;\n            this.observeArray(data)\n        } else {\n            this.walk(data)\n        }\n    }\n    /**\n     * æ— è®ºæ•°ç»„è¿˜æ˜¯å¯¹è±¡, éƒ½è¦éå†å…¶ä¸­çš„æ¯ä¸€é¡¹ åšå“åº”å¼å¤„ç†\n     */\n    observeArray(data) {\n        for (let i = 0; i < data.length; i++) {\n            observe(data[i]);\n        }\n    }\n    walk(data) {\n        Object.keys(data).forEach((key) => {\n            defineReactive(data, key, data[key])\n        })\n    }\n\n}\n\n/**\n * vue2.0 æœ‰æ€§èƒ½é—®é¢˜: é€’å½’é‡å†™get set æ•°æ®åµŒå¥—å¾ˆå¤§çš„è¯ æ€§èƒ½å¾ˆå·®. vue3 ä½¿ç”¨proxyå¾—åˆ°ä¼˜åŒ–ğŸ‚\n * \n */\n\nfunction defineReactive(data, key, value) {\n    observe(value) // valueå¯èƒ½è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ é€’å½’å¾ªç¯æ£€æµ‹ä¸€ä¸‹\n\n    let dep = new Dep();\n\n    Object.defineProperty(data, key, {\n        get() {\n            console.log('å¯¹è±¡çš„getæ–¹æ³•');\n            // ç”¨æˆ·å–å€¼çš„æ—¶å€™ ä¼šè§¦å‘get ç»™è¿™ä¸ªå±æ€§æ·»åŠ ä¸€ä¸ªdepå±æ€§ï¼Œ è®©è¿™ä¸ªdepå»æ”¶é›†watcher\n            // æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„dep\n            if (Dep.target) {\n                dep.depend()\n            }\n            return value\n        },\n        set(newVal) {\n            if (newVal === value) return\n            observe(newVal)\n            value = newVal\n            console.log('å¯¹è±¡çš„setæ–¹æ³•');\n\n            // å½“æ•°æ®æ›´æ–°å æ‰§è¡Œå½“å‰depå¯¹åº”çš„watcher  \n            dep.notify()\n        }\n    })\n}\n\n\nexport function observe(data) {\n    // å¦‚æœä¸æ˜¯å¯¹è±¡ å°±ä¸ç”¨åšå“åº”å¼å¤„ç†\n    if (!isObject(data)) {\n        return;\n    }\n    // å¦‚æœæœ‰__ob__å±æ€§    è¡¨ç¤ºè§‚æµ‹è¿‡ ä¹Ÿç›´æ¥è·³å‡º\n    if (data.__ob__ instanceof Observe) {\n        return;\n    }\n    // è¿”å›ä¸€ä¸ªobserveå®ä¾‹, è§‚æµ‹çš„æ ¸å¿ƒä»£ç åœ¨è¿™é‡Œ, ä¸€ä¸ªå¯¹è±¡ å¯¹åº”ä¸€ä¸ªobå®ä¾‹ \n    return new Observe(data)\n}","import { observe } from './observer/index'\nexport function initState(vm) {\n    const opts = vm.$options\n\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.methods) {\n        initMethod(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n\n    function initProps(vm) {\n\n    }\n    function initMethod(vm) {\n\n    }\n    function initData(vm) {\n        // è¿™é‡Œå°±æ˜¯å¦‚ä½•åšæ•°æ®å“åº”å¼çš„æºç ,é¦–å…ˆæ‹¿åˆ°ç”¨æˆ·ä¼ å…¥çš„æ•°æ®\n        let data = vm.$options.data;\n\n        if (typeof data === 'function') {\n            data = vm._data = data.call(vm)\n        } else {\n            data = vm._data = data\n        }\n\n        // æŠŠæ•°æ®ä»£ç†åˆ°vmå®ä¾‹ä¸Š, æ–¹ä¾¿å–çš„æ—¶å€™ç›´æ¥å¯ä»¥ vm.msg\n        for (const key in data) {\n            if (data.hasOwnProperty(key)) {\n                proxy(vm, '_data', key)                \n            }\n        }\n        // è§‚æµ‹æ•°æ®\n        observe(data)\n    }\n\n    function proxy(target, property, key){\n        Object.defineProperty(target, key, {\n            get(){\n                return target[property][key]\n            },\n            set(newVal){\n                target[property][key] = newVal\n            }\n        })\n    }\n}\n","//              å­—æ¯a-zA-Z_ - . æ•°ç»„å°å†™å­—æ¯ å¤§å†™å­—æ¯  \nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // æ ‡ç­¾å\n// ?:åŒ¹é…ä¸æ•è·   <aaa:aaa>\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\n// startTagOpen å¯ä»¥åŒ¹é…åˆ°å¼€å§‹æ ‡ç­¾ æ­£åˆ™æ•è·åˆ°çš„å†…å®¹æ˜¯ (æ ‡ç­¾å)\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // æ ‡ç­¾å¼€å¤´çš„æ­£åˆ™ æ•è·çš„å†…å®¹æ˜¯æ ‡ç­¾å\n// é—­åˆæ ‡ç­¾ </xxxxxxx>  \nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // åŒ¹é…æ ‡ç­¾ç»“å°¾çš„ </div>\n// <div aa   =   \"123\"  bb=123  cc='123'\n// æ•è·åˆ°çš„æ˜¯ å±æ€§å å’Œ å±æ€§å€¼ arguments[1] || arguments[2] || arguments[2]\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // åŒ¹é…å±æ€§çš„\n// <div >   <br/>\nconst startTagClose = /^\\s*(\\/?)>/; // åŒ¹é…æ ‡ç­¾ç»“æŸçš„ >\n// åŒ¹é…åŠ¨æ€å˜é‡çš„  +? å°½å¯èƒ½å°‘åŒ¹é…\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nexport function parseHTML(html) {\n    // ast æ ‘ è¡¨ç¤ºhtmlçš„è¯­æ³•\n    let root; // æ ‘æ ¹ \n    let currentParent;\n    let stack = []; // ç”¨æ¥åˆ¤æ–­æ ‡ç­¾æ˜¯å¦æ­£å¸¸é—­åˆ  [div]  è§£æå™¨å¯ä»¥å€ŸåŠ©æ ˆå‹ç»“æ„\n    // <div id=\"app\" style=\"color:red\"><span>    helloworld {{msg}}   </span></div>\n\n    // vue2.0 åªèƒ½æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ å¿…é¡»æ˜¯html å…ƒç´ \n\n    // å¸¸è§æ•°æ®ç»“æ„ æ ˆ é˜Ÿåˆ— æ•°ç»„ é“¾è¡¨ é›†åˆ hashè¡¨ æ ‘\n    function createASTElement(tagName, attrs) {\n        return {\n            tag: tagName,\n            attrs,\n            children: [],\n            parent: null,\n            type: 1 // 1 æ™®é€šå…ƒç´   3 æ–‡æœ¬\n        }\n    }\n    // console.log(html)\n    function start(tagName, attrs) { // å¼€å§‹æ ‡ç­¾ æ¯æ¬¡è§£æå¼€å§‹æ ‡ç­¾ éƒ½ä¼šæ‰§è¡Œæ­¤æ–¹æ³•\n        let element = createASTElement(tagName, attrs);\n        if (!root) {\n            root = element; // åªæœ‰ç¬¬ä¸€æ¬¡æ˜¯æ ¹\n        }\n        currentParent = element;\n        stack.push(element);\n    }\n    // <div> <span></span> hello world</div>   [div,span]\n    function end(tagName) { // ç»“æŸæ ‡ç­¾  ç¡®ç«‹çˆ¶å­å…³ç³»\n        let element = stack.pop();\n        currentParent = stack[stack.length - 1];\n        if (currentParent) {\n            element.parent = currentParent;\n            currentParent.children.push(element);\n        }\n    }\n\n    function chars(text) { // æ–‡æœ¬\n        text = text.replace(/\\s/g, '');\n        if (text) {\n            currentParent.children.push({\n                type: 3,\n                text\n            })\n        }\n    }\n    // æ ¹æ® html è§£ææˆæ ‘ç»“æ„  </span></div>\n    while (html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd == 0) {\n            const startTageMatch = parseStartTag();\n\n            if (startTageMatch) {\n                // å¼€å§‹æ ‡ç­¾\n                start(startTageMatch.tagName, startTageMatch.attrs)\n            }\n            const endTagMatch = html.match(endTag);\n\n            if (endTagMatch) {\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1])\n            }\n            // ç»“æŸæ ‡ç­¾ \n        }\n\n        // å¦‚æœä¸æ˜¯0 è¯´æ˜æ˜¯æ–‡æœ¬\n        let text;\n        if (textEnd > 0) {\n            text = html.substring(0, textEnd); // æ˜¯æ–‡æœ¬å°±æŠŠæ–‡æœ¬å†…å®¹è¿›è¡Œæˆªå–\n            chars(text);\n        }\n        if (text) {\n            advance(text.length); // åˆ é™¤æ–‡æœ¬å†…å®¹\n        }\n    }\n\n    function advance(n) {\n        html = html.substring(n);\n    }\n\n    function parseStartTag() {\n        const start = html.match(startTagOpen); // åŒ¹é…å¼€å§‹æ ‡ç­¾\n        if (start) {\n            const match = {\n                tagName: start[1], // åŒ¹é…åˆ°çš„æ ‡ç­¾å\n                attrs: []\n            }\n            advance(start[0].length);\n            let end, attr;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length);\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n            };\n            if (end) {\n                advance(end[0].length);\n                return match;\n            }\n        }\n    }\n\n    return root;\n\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\nfunction genProps(attrs){  // {id:'app',style:{color:red}}\n    let str = ''\n    for(let i = 0; i<attrs.length; i++){\n        let attr = attrs[i]; // å–åˆ°æ¯ä¸€ä¸ªå±æ€§\n        if(attr.name === 'style'){\n            let obj = {}; //  color:red;background:green\n            attr.value.split(';').forEach(item=>{\n                let [key,value] = item.split(':');\n                obj[key] = value;\n            });\n            attr.value = obj; // å°†åŸæ¥çš„å­—ç¬¦ä¸²æ¢æˆäº† åˆšæ‰æ ¼å¼åŒ–åçš„å¯¹è±¡\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0,-1)}}`;\n}\nfunction gen(node){\n    if(node.type === 1){\n        return generate(node)\n    }else{\n        // æ–‡æœ¬çš„å¤„ç†\n        let text = node.text;\n        if(!defaultTagRE.test(text)){  // æœ‰å˜é‡ {{}}\n            return `_v(${JSON.stringify(text)})` // _v('helloworld')\n        }else{\n            let tokens = []; // æ¯æ¬¡æ­£åˆ™ä½¿ç”¨è¿‡å éƒ½éœ€è¦é‡æ–°æŒ‡å®š lastIndex  aaaab\n            let lastIndex =  defaultTagRE.lastIndex = 0;\n            let match,index;\n            while(match = defaultTagRE.exec(text)){\n                index = match.index;\n                // é€šè¿‡ lastIndex,ndex\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n                tokens.push(`_s(${match[1].trim()})`);\n                lastIndex = index + match[0].length\n            }\n            if(lastIndex < text.length){\n                tokens.push(JSON.stringify(text.slice(lastIndex)));\n            }\n            return `_v(${tokens.join('+')})`\n        }\n        // helloworld {{  msg  }}  aa {{bb}}  aaa   => _v('helloworld'+_s(msg)+\"aa\" + _s(bb))\n    }\n}  \nfunction genChildren(el){ // <div><span></span> hello</div>\n    const children = el.children;\n    if(children){\n        return children.map(c=>gen(c)).join(',')\n    }else{\n        return false\n    }\n}\nexport function generate(el){\n    let children = genChildren(el); // ç”Ÿæˆå­©å­å­—ç¬¦ä¸²\n    let code = `_c(\"${el.tag}\",${\n            el.attrs.length? `${genProps(el.attrs)}`  : undefined\n        }${\n            children? `,${children}` :''\n        })`;\n\n    return code;\n}\n// è¯­æ³•çº§çš„ç¼–è¯‘ ","import {parseHTML} from './parser.js'\nimport {generate} from './generator.js';\n\n// template => renderå‡½æ•°  å®ç°æ¨¡ç‰ˆçš„ç¼–è¯‘\nexport function compileToFunctions(template) {\n    // æ ¹æ®æ¨¡ç‰ˆ é€šè¿‡æ­£åˆ™åŒ¹é…  è§£æå­—ç¬¦ä¸² ç”ŸæˆastæŠ½è±¡è¯­æ³•æ ‘  æ˜¯ä¸ªobject  ä¸åŒäºvnode è¡¨é¢å’Œvnodeå¾ˆåƒ\n    let ast = parseHTML(template)\n\n    // æ ¸å¿ƒæ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ è§£æast\n    let code = generate(ast)\n    code = `with(this) { \\r\\nreturn ${code} \\r\\n}`\n    /**\n     * render(){ \n        * with(this){\n        *  return _c('div',{id:app,style:{color:red}},_c('span',undefined,_v(\"helloworld\"+_s(msg)) ))\n        * }\n     * }\n     * æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆå‡½æ•°\n     */\n    const render = new Function(code)\n    return render;\n    // æ¨¡æ¿ç¼–è¯‘åŸç† \n    // 1.å…ˆæŠŠæˆ‘ä»¬çš„ä»£ç è½¬åŒ–æˆastè¯­æ³•æ ‘ ï¼ˆ1ï¼‰  parser è§£æ  (æ­£åˆ™)\n    // 2.æ ‡è®°é™æ€æ ‘  ï¼ˆ2ï¼‰ æ ‘å¾—éå†æ ‡è®° markup  åªæ˜¯ä¼˜åŒ–\n    // 3.é€šè¿‡astäº§ç”Ÿçš„è¯­æ³•æ ‘ ç”Ÿæˆ ä»£ç  =ã€‹ renderå‡½æ•°  codegen\n}","let has = {}; // vueæºç é‡Œæœ‰çš„æ—¶å€™å»é‡ç”¨çš„æ˜¯set æœ‰çš„æ—¶å€™ç”¨çš„æ˜¯å¯¹è±¡æ¥å®ç°çš„å»é‡\nlet queue = [];\n\n// è¿™ä¸ªé˜Ÿåˆ—æ˜¯å¦æ­£åœ¨ç­‰å¾…æ›´æ–°\nfunction flushSchedulerQueue() {\n    for (let i = 0; i < queue.length; i++) {\n        queue[i].run();\n    }\n    queue = [];\n    has = {};\n}\n\n\nexport function queueWatcher(watcher) {\n    const id = watcher.id;\n\n    if (has[id] == null) {\n        has[id] = true; // å¦‚æœæ²¡æœ‰æ³¨å†Œè¿‡è¿™ä¸ªwatcherï¼Œå°±æ³¨å†Œè¿™ä¸ªwatcheråˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºå·²ç»æ³¨å†Œ\n        queue.push(watcher);\n        nextTick(flushSchedulerQueue); // flushSchedulerQueue è°ƒç”¨æ¸²æŸ“watcher\n\n    }\n}\nlet callbacks = []; // [flushSchedulerQueue,fn]\nlet pending = false;\nfunction flushCallbacksQueue() {\n    callbacks.forEach(fn => fn());\n    pending = false;\n}\n\nexport function nextTick(fn) {\n    callbacks.push(fn); // é˜²æŠ–\n    if (!pending) { // true  äº‹ä»¶ç¯çš„æ¦‚å¿µ promise mutationObserver setTimeout setImmediate\n        setTimeout(() => {\n            flushCallbacksQueue();\n        }, 0);\n        pending = true\n    }\n}","import { pushTarget, popTarget } from \"./dep\";\nimport { queueWatcher } from \"./scheduler\";\nimport { callHook } from \"../lifecycle\";\n\n// æ¯ä¸€ä¸ªwatcheréƒ½æœ‰ä¸€ä¸ªid ä»£è¡¨ç€watcherçš„å”¯ä¸€æ€§\n// ç›®å‰å†™åˆ°è¿™ åªæœ‰ä¸€ä¸ªæ¸²æŸ“watcher  åªè¦æ¨¡ç‰ˆä¸­ç”¨åˆ°äº†è¿™ä¸ªå±æ€§ å½“å±æ€§å˜åŒ–äº† å°±æ›´æ–°è§†å›¾\n// watcherå¯ä»¥çœ‹æˆæ˜¯ä¸ªå›è°ƒå‡½æ•°\nlet id = 0;\nclass Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.vm = vm;\n        this.exprOrFn = exprOrFn;\n        this.cb = cb;\n        this.options = options;\n        this.deps = [];\n        this.depsId = new Set();\n        this.id = id++;\n        if (typeof exprOrFn === 'function') {\n            this.getter = exprOrFn\n        }\n        this.get()\n    }\n    // new Watcherçš„æ—¶å€™å…ˆæŠŠæ¸²æŸ“watcherå®ä¾‹ å­˜åœ¨ Dep.targetä¸Š\n    // this.getter() å°±æ˜¯è¦æ¸²æŸ“é¡µé¢ å¿…å°†definePropertyå–å€¼ \n    // æ­¤æ—¶æˆ‘å°±å¯ä»¥æ‹¿åˆ°å…¨å±€çš„Dep.target \n    // æ¯ä¸€ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªdep å–å€¼å°±æ˜¯å°†Dep.target å’Œ dep åŒå‘è®°å¿†\n    // æ•°æ®å˜åŒ– é€šçŸ¥watcheræ›´æ–°\n    get(){\n        pushTarget(this)\n        this.getter()\n        popTarget()\n    }\n    // å±æ€§çš„getæ–¹æ³•è¢«æ‹¦æˆª æ‰§è¡Œdep.depend() å…¶å®æ˜¯Dep.target.addDep(this)\n    // æŠŠdepä¼ ç»™watcheräº†  ç„¶åä¸¤è€…åŒå‘è®°å¿† å»é‡\n    addDep(dep){\n        if (!this.depsId.has(dep.id)) {\n            this.depsId.add(dep.id)\n            this.deps.push(dep)\n            dep.addSub(this) // è®©å½“å‰dep è®¢é˜…è¿™ä¸ªwatcher\n        }\n    }\n    // è™½ç„¶æ›´æ–° ä½†æˆ‘æ˜¯å¼‚æ­¥æ›´æ–° æ‰€ä»¥æŠŠwatcherå…ˆæ”¾è¿›å» æ²¡æœ‰é©¬ä¸Šæ‰§è¡Œ\n    update(){\n        queueWatcher(this)\n    }\n    // å†™ä¸€ä¸ªå¤‡ç”¨çš„runæ–¹æ³• ä¾›å¼‚æ­¥æ›´æ–°ä½¿ç”¨\n    // this.get() ä¼šå¯¼è‡´é¡µé¢é‡æ–°æ¸²æŸ“\n    run(){\n        this.get()\n    }\n}\n\n\nexport default Watcher\n\n/**\n * ç»„ä»¶mountçš„æ—¶å€™ ä¼š new Watcher ä¸€ä¸ªå®ä¾‹  ç¬¬äºŒä¸ªå‚æ•°æ˜¯updateComponent æ›´æ–°å‡½æ•°\n * new Watcher é‡Œä¼šæ‰§è¡Œ æ¥è‡ªäºDepçš„ pushTarget(this) thiså°±æ˜¯watcherå®ä¾‹\n * è¿™é‡Œå¤ªå·§å¦™äº†  æ‰§è¡Œwatcherçš„æ—¶å€™ å´åœ¨ æ“ä½œdep æŠŠwatcherèµ‹ç»™Dep.target å¹¶å­˜èµ·æ¥\n *\n * å½“å±æ€§ getè¢«è°ƒç”¨çš„æ—¶å€™ dep.depend å†æŠŠå½“å‰å¯ä»¥å¯¹åº”çš„depå±æ€§ å­˜åˆ°watcheré‡Œ  Dep.target.addDep\n *\n */","export function patch(oldVnode, newVnode) {\n    const isRealElement = oldVnode.nodeType;\n    if (isRealElement) {\n        // çœŸå®å…ƒç´ \n        const oldElm = oldVnode;\n        const parentElm = oldElm.parentNode;\n        let el = createElm(newVnode);\n        parentElm.insertBefore(el, oldElm.nextSibling)\n        parentElm.removeChild(oldElm);\n        return el; // æ¸²æŸ“çš„çœŸå®dom\n    } else {\n        // dom diff ç®—æ³•  åŒå±‚æ¯”è¾ƒ ï¼ˆé»˜è®¤æƒ³å®Œæ•´æ¯”å¯¹ä¸€æ£µæ ‘ O(n^3)ï¼‰  O(n)\n        // ä¸éœ€è¦è·¨çº§æ¯”è¾ƒ\n\n        // ä¸¤æ£µæ ‘ è¦å…ˆæ¯”è¾ƒæ ‘æ ¹ä¸€ä¸ä¸€æ ·ï¼Œå†å»æ¯”å„¿å­é•¿çš„æ˜¯å¦ä¸€æ ·\n\n        if (oldVnode.tag !== newVnode.tag) { // æ ‡ç­¾åä¸ä¸€è‡´ è¯´æ˜æ˜¯ä¸¤ä¸ªä¸ä¸€æ ·çš„èŠ‚ç‚¹\n            oldVnode.el.parentNode.replaceChild(createElm(newVnode), oldVnode.el);\n        }\n        // æ ‡ç­¾ä¸€è‡´ div  éƒ½æ˜¯æ–‡æœ¬ tag = undefined\n\n        if (!oldVnode.tag) { // å¦‚æœæ˜¯æ–‡æœ¬ æ–‡æœ¬å˜åŒ–äº† ç›´æ¥ç”¨æ–°çš„æ–‡æœ¬æ›¿æ¢æ‰è€çš„æ–‡æœ¬\n            if (oldVnode.text !== newVnode.text) {\n                oldVnode.el.textContent = newVnode.text;\n            }\n        }\n        // ä¸€å®šæ˜¯æ ‡ç­¾äº† è€Œä¸”æ ‡ç­¾ä¸€è‡´\n        // éœ€è¦å¤ç”¨è€çš„èŠ‚ç‚¹ æ›¿æ¢æ‰è€çš„å±æ€§\n        let el = newVnode.el = oldVnode.el;\n        // æ›´æ–°å±æ€§  diff å±æ€§\n        updateProperties(newVnode, oldVnode.data); // æ­¤æ—¶å±æ€§å°±æ›´æ–°å®Œæ¯•äº† å½“å‰çš„æ ‘æ ¹å·²ç»å®Œæˆäº†\n\n        // æ¯”å¯¹å­©å­èŠ‚ç‚¹\n        let oldChildren = oldVnode.children || []; // è€çš„å­©å­\n        let newChildren = newVnode.children || []; // æ–°çš„å­©å­\n\n        // æ–°è€éƒ½æœ‰å­©å­ é‚£å°±æ¯”è¾ƒ diffæ ¸å¿ƒ\n        // è€çš„æœ‰å­©å­ æ–°çš„æ²¡å­©å­ ç›´æ¥åˆ é™¤\n        // æ–°çš„æœ‰å­©å­  è€çš„æ²¡å­©å­ ç›´æ¥æ’å…¥\n\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // diff  ä¸¤ä¸ªäººéƒ½æœ‰å„¿å­ ** è¿™é‡Œè¦ä¸åœçš„å»æ¯”è¾ƒå­©å­èŠ‚ç‚¹\n            updateChildren(el, oldChildren, newChildren);\n            // é€šè¿‡æ¯”è¾ƒè€å­©å­å’Œæ–°å­©å­ æ“ä½œelä¸­çš„å„¿å­\n\n        } else if (oldChildren.length > 0) {\n            el.innerHTML = '';\n        } else if (newChildren.length > 0) {\n            for (let i = 0; i < newChildren.length; i++) {\n                let child = newChildren[i]; // æ‹¿åˆ°ä¸€ä¸ªä¸ªçš„å­©å­\n                el.appendChild(createElm(child)); // æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¼˜åŒ–\n            }\n        }\n        return el;\n    }\n}\n\nfunction isSameVnode(oldVnode, newVnode) {\n    return (oldVnode.key == newVnode.key) && (oldVnode.tag === newVnode.tag);\n}\n\nfunction updateChildren(parent, oldChildren, newChildren) {\n    // Vue2.0 ä½¿ç”¨åŒæŒ‡é’ˆçš„æ–¹å¼ æ¥è¿›è¡Œæ¯”å¯¹\n    // v-for è¦æœ‰key  keyå¯ä»¥æ ‡è¯†å…ƒç´  æ˜¯å¦å‘ç”Ÿå˜åŒ– å‰åçš„keyç›¸åŒåˆ™å¯ä»¥å¤ç”¨è¿™ä¸ªå…ƒç´ \n\n    let oldStartIndex = 0; // è€çš„å¼€å§‹çš„ç´¢å¼•\n    let oldStartVnode = oldChildren[0]; // è€çš„å¼€å§‹\n    let oldEndIndex = oldChildren.length - 1; // è€çš„å°¾éƒ¨ç´¢å¼•\n    let oldEndVnode = oldChildren[oldEndIndex]; // è·å–è€çš„å­©å­çš„æœ€åä¸€ä¸ª\n\n    let newStartIndex = 0; // è€çš„å¼€å§‹çš„ç´¢å¼•\n    let newStartVnode = newChildren[0]; // è€çš„å¼€å§‹\n    let newEndIndex = newChildren.length - 1; // è€çš„å°¾éƒ¨ç´¢å¼•\n    let newEndVnode = newChildren[newEndIndex]; // è·å–è€çš„å­©å­çš„æœ€åä¸€ä¸ª\n\n    function makeIndexByKey(children) { // åªéœ€è¦åˆ›å»ºä¸€æ¬¡ æ˜ å°„è¡¨\n        let map = {};\n        children.forEach((item, index) => {\n            map[item.key] = index;\n        })\n        return map\n    }\n    let map = makeIndexByKey(oldChildren); // æ ¹æ®è€çš„å­©å­çš„key åˆ›å»ºä¸€ä¸ªæ˜ å°„è¡¨ \n    // 1æ–¹æ¡ˆ1 å…ˆå¼€å§‹ä»å¤´éƒ¨è¿›è¡Œæ¯”è¾ƒ  O(n)  ä¼˜åŒ–å‘åæ’å…¥çš„é€»è¾‘\n    // æ¯”è¾ƒæ—¶ å°±æ˜¯é‡‡ç”¨æœ€çŸ­çš„è¿›è¡Œæ¯”è¾ƒï¼Œå‰©ä¸‹çš„è¦ä¸æ˜¯åˆ é™¤è¦ä¹ˆæ˜¯å¢åŠ \n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n        // å¦‚ä½•åˆ¤æ–­ ä¸¤ä¸ªè™šæ‹ŸèŠ‚ç‚¹æ˜¯å¦ä¸€è‡´ å°±æ˜¯ç”¨key + type è¿›è¡Œåˆ¤æ–­\n        if (!oldStartVnode) {\n            oldStartVnode = oldChildren[++oldStartIndex];\n        } else if (!oldEndVnode) {\n            oldEndVnode = oldChildren[--oldEndIndex]\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\n            //æ ‡ç­¾å’Œkeyä¸€è‡´ ä½†æ˜¯ å…ƒç´ å¯èƒ½å±æ€§ä¸ä¸€è‡´\n            patch(oldStartVnode, newStartVnode); //è‡ªèº«å±æ€§ +  é€’å½’æ¯”è¾ƒ\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newStartVnode = newChildren[++newStartIndex];\n            //  æŒ‡é’ˆä¸åœçš„åœ¨åŠ¨\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\n            // 2 æ–¹æ¡ˆ2  ä»å°¾éƒ¨å¼€å§‹æ¯”è¾ƒ å¦‚æœå¤´éƒ¨ä¸ä¸€è‡´ å¼€å§‹å°¾éƒ¨æ¯”è¾ƒï¼Œ ä¼˜åŒ–å‘å‰æ’å…¥\n            patch(oldEndVnode, newEndVnode);\n            oldEndVnode = oldChildren[--oldEndIndex]; // ç§»åŠ¨å°¾éƒ¨æŒ‡é’ˆ\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) { // æ­£åº  å’Œ å€’å™  reverst sort\n            // 3æ–¹æ¡ˆ3 å¤´ä¸ä¸€æ · å°¾ä¸ä¸€æ ·  å¤´ç§»å°¾  å€’åºæ“ä½œ\n            patch(oldStartVnode, newEndVnode);\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling); // å…·å¤‡ç§»åŠ¨æ€§\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) { // è€çš„å°¾ å’Œæ–°çš„å¤´æ¯”å¯¹\n            patch(oldEndVnode, newStartVnode);\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el)\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else {\n            // ä¹±åºæ¯”å¯¹  æœ€ç»ˆå¤„ç†\n            let moveIndex = map[newStartVnode.key];\n            if (moveIndex == undefined) { // æ˜¯ä¸€ä¸ªæ–°å…ƒç´  ï¼Œåº”è¯¥æ·»åŠ è¿›å»\n                parent.insertBefore(createElm(newStartVnode), oldStartVnode.el)\n            } else {\n                let moveVnode = oldChildren[moveIndex];\n                oldChildren[moveIndex] = null; // å ä½ å¦‚æœç›´æ¥åˆ é™¤ å¯èƒ½ä¼šå¯¼è‡´æ•°ç»„å¡Œé™·  [a,b,null,d]\n\n                // æ¯”å¯¹å½“å‰è¿™ä¸¤ä¸ªå…ƒç´ å±æ€§å’Œå„¿å­\n                patch(moveVnode, newStartVnode);\n                parent.insertBefore(moveVnode.el, oldStartVnode.el);\n            }\n            newStartVnode = newChildren[++newStartIndex]; // ç§»åŠ¨æ–°çš„æŒ‡é’ˆ\n        }\n\n    }\n    if (newStartIndex <= newEndIndex) {\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\n            // appendChild   =  insertBefore null  jsåŸç”Ÿæ“ä½œ\n            let ele = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el\n            parent.insertBefore(createElm(newChildren[i]), ele);\n            // parent.appendChild(createElm(newChildren[i]))\n        }\n    }\n    if (oldStartIndex <= oldEndIndex) { // è¯´æ˜æ–°çš„å·²ç»å¾ªç¯å®Œæ¯•äº† è€çš„æœ‰å‰©ä½™ å‰©ä½™å°±æ˜¯ä¸è¦çš„\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n            let child = oldChildren[i];\n            if (child != null) {\n                parent.removeChild(child.el);\n            }\n        }\n    }\n\n    // æ²¡æœ‰key å°±ç›´æ¥æ¯”è¾ƒç±»å‹ï¼Œå¦‚æœç±»å‹ä¸€æ ·å°±å¤ç”¨ ï¼ˆéšè—çš„é—®é¢˜æ˜¯å„¿å­å¯èƒ½éƒ½éœ€è¦é‡æ–°åˆ›å»ºï¼‰\n    // å¾ªç¯æ—¶å°½é‡é‡‡ç”¨å”¯ä¸€çš„æ ‡è¯† ä½œä¸ºkey å¦‚æœç”¨ç´¢å¼•ï¼ˆä¾‹å¦‚å€’å™ ä¼šé‡‡ç”¨ç´¢å¼•æ¥å¤ç”¨ï¼Œä¸å¤Ÿå‡†ç¡®ï¼‰ å¦‚æœæ˜¯é™æ€æ•°æ® ï¼ˆä½ çˆ±ç”¨å•¥ç”¨å•¥ï¼‰\n\n\n\n}\nexport function createElm(vnode) { // éœ€è¦é€’å½’åˆ›å»º\n    let { tag, children, data, key, text } = vnode;\n    if (typeof tag == 'string') {\n        // å…ƒç´  // å°†è™šæ‹ŸèŠ‚ç‚¹å’ŒçœŸå®èŠ‚ç‚¹åšä¸€ä¸ªæ˜ å°„å…³ç³» ï¼ˆåé¢diffæ—¶å¦‚æœå…ƒç´ ç›¸åŒç›´æ¥å¤ç”¨è€å…ƒç´  ï¼‰\n        vnode.el = document.createElement(tag);\n        updateProperties(vnode); // è·Ÿæ–°å…ƒç´ å±æ€§\n        children.forEach(child => {\n            // é€’å½’æ¸²æŸ“å­èŠ‚ç‚¹ å°†å­èŠ‚ç‚¹ æ¸²æŸ“åˆ°çˆ¶èŠ‚ç‚¹ä¸­\n            vnode.el.appendChild(createElm(child));\n        });\n    } else {\n        // æ™®é€šçš„æ–‡æœ¬\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el\n}\n\nfunction updateProperties(vnode, oldProps = {}) {\n\n    // éœ€è¦æ¯”è¾ƒ vnode.data å’Œ oldPropsçš„å·®å¼‚\n\n    let el = vnode.el;\n    let newProps = vnode.data || {};\n    // è·å–è€çš„æ ·å¼å’Œæ–°çš„æ ·å¼çš„å·®å¼‚ å¦‚æœæ–°çš„ä¸Šé¢ä¸¢å¤±äº†å±æ€§ åº”è¯¥åœ¨è€çš„å…ƒç´ ä¸Šåˆ é™¤æ‰\n    let newStyle = newProps.style || {};\n    let oldStyle = oldProps.style || {};\n\n    for (let key in oldStyle) {\n        if (!newStyle[key]) {\n            el.style[key] = ''; // åˆ é™¤ä¹‹å‰çš„æ ·å¼\n        }\n    }\n    for (let key in oldProps) {\n        if (!newProps[key]) { // æ­¤æ—¶çš„å…ƒç´ ä¸€æ˜¯ä»¥å‰\n            el.removeAttribute(key);\n        }\n    }\n\n    // å…¶ä»–æƒ…å†µç›´æ¥ç”¨æ–°çš„å€¼è¦†ç›–æ‰è€çš„å€¼å³å¯\n    for (let key in newProps) {\n        if (key == 'style') {\n            for (let styleName in newProps.style) { // {color:red,background:green}\n                el.style[styleName] = newProps.style[styleName]\n            }\n            // æµè§ˆå™¨é‡æ–°æ¸²æŸ“ä¹Ÿä¼šçœ‹å€¼æ˜¯å¦å˜åŒ–\n        }\n        // event \n        else {\n            el.setAttribute(key, newProps[key]);\n        }\n    }\n}","import Watcher from './observer/watcher';\nimport { patch } from './vdom/patch';\nexport function lifeCycleMixin(Vue) {\n    Vue.prototype._update = function(vnode){\n        // ä¼ å…¥vnode å¾—åˆ°çœŸå®dom  æŒ‚åœ¨vm.$el ä¸Š\n        const vm = this;\n        vm.$el = patch(vm.$el, vnode)\n    }\n}\nexport function mountComponent(vm, el) {\n    // vueåœ¨æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ ä¼šåˆ›å»ºä¸€ä¸ª æ‰€è°“çš„æ¸²æŸ“watcher åªç”¨æ¥æ¸²æŸ“çš„\n    // watcher å°±æ˜¯ä¸€ä¸ªå›è°ƒ æ¯æ¬¡æ•°æ®å˜åŒ– å°±ä¼šé‡æ–°æ‰§è¡Œwatcher\n    // vue ä¸æ˜¯çº¯ç²¹çš„ MVVM æ¡†æ¶\n    callHook(vm, 'beforeMount')\n    function updateComponent() {\n        console.log('updateComponent');\n        vm._update(vm._render())\n    }\n\n    new Watcher(vm, updateComponent, () => { }, true);\n\n    callHook(vm, 'mounted')\n}\n\n\nexport function callHook(vm, hook) { // vm.$options\n    let handlers = vm.$options[hook]; // å…¸å‹çš„å‘å¸ƒè®¢é˜…æ¨¡å¼\n    if (handlers) {\n        for (let i = 0; i < handlers.length; i++) { // [fn,fn,fn]\n            handlers[i].call(vm); // æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸçš„this æŒ‡å‘çš„éƒ½æ˜¯å½“å‰çš„å®ä¾‹\n        }\n    }\n}","import { initState } from './state'\nimport { compileToFunctions } from './compiler/index.js'\nimport { mountComponent } from './lifecycle.js'\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n\n        const vm = this;\n        // Vue å†…çš„$options å°±æ˜¯ç”¨æˆ·ä¼ å…¥çš„æ‰€æœ‰å‚æ•°\n        vm.$options = options\n\n        // åˆå§‹åŒ–çŠ¶æ€\n        initState(vm)\n\n\n        // æ ¹æ®æ¨¡ç‰ˆè¿›è¡Œæ¸²æŸ“, ç”¨æˆ·ä¼ å…¥äº†elå±æ€§æ‰æ‰§è¡ŒæŒ‚è½½ $mount  å¦åˆ™è¦æ‰‹åŠ¨ \n        if (vm.$options.el) {\n            vm.$mount(vm.$options.el)\n        }\n    }\n    /**\n     * ä¼ å…¥çš„elå¯ä»¥æ˜¯å­—ç¬¦ä¸² ä¹Ÿå¯ä»¥æ˜¯domå¯¹è±¡. è¿™é‡Œé»˜è®¤æ˜¯string æºç ä¸­æœ‰åˆ¤æ–­ typeof el === 'string'\n     * è¯¦è§ 171é¡µ\n     * ä¸‰è€…çš„ä¼˜å…ˆçº§:  render > template > el\n     */\n    Vue.prototype.$mount = function (el) {\n        const vm = this;\n        el = vm.$el = document.querySelector(el)\n        // å¦‚æœrenderä¸å­˜åœ¨ å°†æ¨¡ç‰ˆç¼–è¯‘æˆrenderå‡½æ•° èµ‹å€¼ç»™$options.render\n        const opts = vm.$options\n        if (!opts.render) {\n            let template = opts.template\n            if (!template && el) {\n                template = el.outerHTML;\n            }\n            const render = compileToFunctions(template)\n            opts.render = render;\n        }\n\n        // renderå­˜åœ¨ å°±ä¸éœ€è¦ç¼–è¯‘äº† ç”¨æˆ·ä¼ å…¥äº†ä¸€ä¸ªrender\n        // æŒ‚è½½å³å¯\n        mountComponent(vm, el)\n    }\n}","export function createTextVNode(text) {\n    return vnode(undefined, undefined, undefined, undefined, text);\n}\nexport function createElement(tag, data = {}, ...children) {\n    // vueä¸­çš„key ä¸ä¼šä½œä¸ºå±æ€§ä¼ é€’ç»™ç»„ä»¶\n\n    \n    return vnode(tag, data, data.key, children)\n}\n// è™šæ‹ŸèŠ‚ç‚¹æ˜¯ äº§ç”Ÿä¸€ä¸ªå¯¹è±¡ ç”¨æ¥æè¿°domç»“æ„ å¢åŠ è‡ªå®šä¹‰å±æ€§\n// ast ä»–æ˜¯æè¿° domè¯­æ³•çš„ \nfunction vnode(tag, data, key, children, text) {\n    return {\n        tag,\n        data,\n        key,\n        children,\n        text,\n    }\n}","import {createTextVNode,createElement} from './vdom/create-element'\nexport function renderMixin(Vue) {\n    Vue.prototype._v = function(text) {\n        // åˆ›å»ºæ–‡æœ¬çš„è™šæ‹ŸåŠè¯¶ç‚¹\n        return createTextVNode(text)\n    }\n    Vue.prototype._c = function() {\n        return createElement(...arguments);\n    }\n    Vue.prototype._s = function(val) {\n        // åˆ¤æ–­å½“å‰è¿™ä¸ªå€¼æ˜¯ä¸æ˜¯å¯¹è±¡ ï¼Œå¦‚æœæ˜¯å¯¹è±¡ ç›´æ¥è½¬æ¢æˆå­—ç¬¦ä¸² ï¼Œé˜²æ­¢é¡µé¢å‡ºç°[object Object]\n        return val == null ? '' : (typeof val === 'object' ? JSON.stringify(val) : val);\n    }\n    Vue.prototype._render = function() {\n        // è°ƒç”¨æˆ‘ä»¬è‡ªå·±å®ç°çš„renderæ–¹æ³•\n\n        const vm = this;\n        const { render } = vm.$options;\n\n       \n        let vnode = render.call(vm); // _c _c  _s\n        return vnode\n    }\n}","/**\n * vueä½¿ç”¨çš„æ˜¯rollupæ‰“åŒ… å®ƒçš„ç‰¹ç‚¹æ˜¯æŠŠå¤šä¸ªå°æ¨¡å— ç»„åˆæˆå¤æ‚çš„é€»è¾‘\n * rollupæ›´ä¸“æ³¨äºæ‰“åŒ…javascriptç±»åº“\n * å¼€å‘åº”ç”¨çš„æ—¶å€™æ›´æ¨èç”¨webpack, å¼€å‘åº“æ—¶ç”¨rollup\n */\nimport { initMixin } from './init'\nimport { renderMixin } from './render.js'\nimport { lifeCycleMixin } from './lifecycle.js'\n\nfunction Vue(options) {\n    // å†…éƒ¨è¦è¿›è¡Œåˆå§‹åŒ–æ“ä½œ\n    this._init(options)\n}\n\n// ç”±äºç»„ä»¶åˆå§‹åŒ– ä¼šæœ‰å¾ˆå¤šæ–¹æ³• åœ¨è¿™é‡Œå†™ä¸€å † Vue.prototype.methods ä¸ä¼˜é›…\n// æ‰€ä»¥ä½¿ç”¨æ··å…¥ æ›´å¥½ é€šè¿‡mixinå¼•å…¥\n\n// åœ¨åŸå‹ä¸Šæ·»åŠ å±æ€§æˆ–æ–¹æ³•\ninitMixin(Vue)  // initState $mount \nrenderMixin(Vue)    // vm._render\nlifeCycleMixin(Vue) // _update\n\n\n\nexport default Vue"],"names":["oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","ob","__ob__","args","result","apply","inserted","slice","observeArray","console","log","isObject","obj","id","Dep","subs","target","addDep","watcher","push","stack","pushTarget","popTarget","pop","length","Observe","data","defineProperty","enumerable","configurable","value","isArray","__proto__","walk","i","observe","keys","key","defineReactive","dep","get","depend","set","newVal","notify","initState","vm","opts","$options","props","initData","_data","call","hasOwnProperty","proxy","property","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","root","currentParent","createASTElement","tagName","attrs","tag","children","parent","type","start","element","end","chars","text","replace","textEnd","indexOf","startTageMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","split","item","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","trim","join","genChildren","el","map","c","code","undefined","compileToFunctions","template","ast","render","Function","has","queue","flushSchedulerQueue","run","queueWatcher","nextTick","callbacks","pending","flushCallbacksQueue","fn","setTimeout","Watcher","exprOrFn","cb","options","deps","depsId","Set","getter","add","addSub","patch","oldVnode","newVnode","isRealElement","nodeType","oldElm","parentElm","parentNode","createElm","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","child","appendChild","isSameVnode","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","makeIndexByKey","moveIndex","moveVnode","ele","vnode","document","createElement","createTextNode","oldProps","newProps","newStyle","style","oldStyle","removeAttribute","styleName","setAttribute","lifeCycleMixin","Vue","_update","$el","mountComponent","callHook","updateComponent","_render","hook","handlers","initMixin","_init","$mount","querySelector","outerHTML","createTextVNode","renderMixin","_v","_c","arguments","_s","val"],"mappings":"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"}