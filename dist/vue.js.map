{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["/**\n * å¯¹æ•°ç»„çš„7ä¸ªæ–¹æ³•åšå‡½æ•°åŠ«æŒ, ä¸ºä»€ä¹ˆæ˜¯è¿™7ä¸ªå‘¢? å› ä¸ºåªæœ‰ä»–ä»¬èƒ½æ”¹å˜æ•°ç»„æœ¬èº«\n * âš ï¸ åœ¨å®é™…åº”ç”¨ä¸­ æ“ä½œæ•°ç»„ç´¢å¼•æ”¹å˜æ•°ç»„ vueæ˜¯æ£€æµ‹ä¸åˆ°çš„  list[0] = 100 âŒ\n * åŸç†: å¤åˆ¶æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³• å¯¹å…¶ä¸­7ä¸ªåšå‡½æ•°åŠ«æŒ AOP\n * å…ˆæ‰§è¡Œè‡ªå®šä¹‰æ–¹æ³• å†è§¦å‘åŸå‹ä¸Šçš„æ–¹æ³• apply \n */\n\nlet oldArrayMethods = Array.prototype;  // è·å–æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•\n\n// åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡, æ ¹æ®åŸå‹é“¾å¯ä»¥æ‰¾åˆ°æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•, è€Œä¸”æ‹“å±•æ–¹æ³•æ—¶ ä¸ä¼šå½±å“åŸæ•°ç»„çš„åŸå‹æ–¹æ³•\nexport let arrayMethods = Object.create(oldArrayMethods)\n\nlet methods = [\n    'push',\n    'pop',\n    'unshift',\n    'shift',\n    'splice',\n    'sort',\n    'reserve'\n]\n\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        const ob = this.__ob__\n        let result = oldArrayMethods[method].apply(ob, args)\n        let inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n        inserted && ob.observeArray(inserted)\n\n        return result;\n    }\n})\n/**\n * ä¸ºä»€ä¹ˆ7ä¸ªæ–¹æ³• åªå¯¹ä¸‰ä¸ªåšäº†å¤„ç†å‘¢?\n * å› ä¸º pushã€unshiftã€splice  å¯ä»¥æ–°å¢å±æ€§. å…¶ä»–å‡ ä¸ªä¸èƒ½æ–°å¢\n * åšå“åº”å¼å¤„ç†çš„ç›®æ ‡æ˜¯å¯¹æ‰€æœ‰æ•°æ®è§‚æµ‹, æ‰€ä»¥ä¸æ˜¯æ–°å¢çš„æ•°æ® ä¸ç”¨å¤„ç†.è™½ç„¶å…¶ä»–çš„æ–¹æ³•ä¹Ÿèƒ½è®©æ•°ç»„æ”¹å˜\n * æ³¨æ„: è¿™ä¸€æ­¥åªåšè§‚æµ‹, ä½¿é¡µé¢æ›´æ–°çš„æ˜¯  è§¦å‘ä¾èµ– ä¸è¦æ··æ·†.\n * è§‚æµ‹å’Œé¡µé¢æ›´æ–°æ²¡æœ‰ç›´æ¥å…³ç³»,è§‚æµ‹æ˜¯ä¸ºæ”¶é›†ã€è§¦å‘ä¾èµ–åšé“ºå«\n */","// æ­¤å¤„æ”¾æ‰€æœ‰çš„å·¥å…·æ–¹æ³•\n\n\nexport function isObject(obj) {\n    return typeof obj === 'object' && obj !== null\n}\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n    'mounted',\n    'beforeUpdate',\n    'updated'\n]\nlet strats = {};\nfunction mergeHook(parentVal,childVal){ // []\n    if(childVal){ // å¦‚æœ å­©å­æœ‰å€¼ \n        if(parentVal){ // çˆ¶äº²æœ‰å€¼ å°±ç›´æ¥æ‹¼æ¥\n            return parentVal.concat(childVal)\n        }else{ // å¦‚æœå­©å­æœ‰å€¼çˆ¶äº²æ²¡å€¼ å°±å°†å­©å­åŒ…è£…æˆæ•°ç»„\n            return [childVal] // Vue.options.beforeCreate = [childVal]\n        }\n    }else{\n        return parentVal; // ç›´æ¥è¿”å›çˆ¶äº²ï¼Œå› ä¸ºæ²¡æœ‰å­©å­  \n    }\n}\nLIFECYCLE_HOOKS.forEach(hook=>{\n    strats[hook] = mergeHook\n})\nexport function mergeOptions(parent,child){ // {...parent,...child}  {a:1.b:2}  {a:{a:{b:2}}}\n    const options = {}\n    // å¦‚æœçˆ¶äº²å’Œå„¿å­é‡Œéƒ½æœ‰ä¸€ä¸ªå±æ€§ è¿™ä¸ªå±æ€§ä¸å†²çª \n    for(let key in parent){ // å¤„ç†çˆ¶äº²çš„æ‰€æœ‰å±æ€§\n        mergeField(key);\n    }\n    for(let key in child){ // å¤„ç†å„¿å­çš„æ‰€æœ‰å±æ€§ï¼Œå¦‚æœçˆ¶äº²æœ‰çš„å€¼ åœ¨ç¬¬ä¸€ä¸ªå¾ªç¯ä¸­å°±å·²ç»å¤„ç†äº†\n        if(!parent.hasOwnProperty(key)){\n            mergeField(key);\n        }\n    }\n    function mergeField(key){\n        // ä¸¤ä¸ªç»„ä»¶é—´ dataæ˜¯å‡½æ•° \n\n        // å†™ä»£ç æ—¶å¾ˆå¿Œè®³ å„ç§if else if else \n\n        // ç­–ç•¥æ¨¡å¼ æ ¹æ®ä¸åŒçš„å±æ€§ è°ƒç”¨ä¸åŒçš„ç­–ç•¥  \n        if(strats[key]){\n            // è¿™é‡Œå°±åŒ…å«äº† mergeHookçš„é€»è¾‘\n            options[key] = strats[key](parent[key],child[key])\n        }else if(isObject(parent[key]) && isObject(child[key])){\n            options[key] = Object.assign(parent[key],child[key])\n        }else{\n            if(child[key] == null){\n                options[key] = parent[key];\n            }else{\n                options[key] = child[key]; // ç”¨å„¿å­çš„å€¼ ç›´æ¥è¦†ç›–æ‰ çˆ¶äº²çš„å€¼\n            }\n        }\n    } // é¢è¯•æ—¶ ç»å¸¸ä¼šæåˆ°å¯¹è±¡é—´çš„åˆå¹¶\n    return options\n}\n","import { arrayMethods } from \"./array\";\nimport {isObject} from '../utils.js'\n\n/**\n * ä¸ºä»€ä¹ˆvueç”¨function è¿™é‡Œç”¨class? \n * å› ä¸º Functionæ„é€ å‡½æ•°æ–¹ä¾¿æ‰©å±•åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•, è¿™é‡Œä¸éœ€è¦\n */\nclass Observe {\n    constructor(data) {\n        /**\n         * 1ã€æ·»åŠ ä¸€ä¸ª__ob__å“åº”å¼æ ‡ç¤º,ä»£è¡¨dataå·²ç»è¢«è§‚æµ‹è¿‡, å¯¹è±¡æ•°ç»„éƒ½æœ‰\n         * 2ã€data.__ob__  = this\n         * åœ¨æ•°æ®ä¸Šå°±å¯ä»¥è·å–åˆ°obå±æ€§, æŒ‡ä»£çš„æ˜¯ observeå®ä¾‹\n         */\n        Object.defineProperty(data, '__ob__', {\n            enumerable: false,\n            configurable: false,\n            value: this\n        })\n        /**\n         * å› ä¸ºå®é™…å¼€å‘ä¸­é€šè¿‡ç´¢å¼•æ“ä½œæ•°ç»„çš„æƒ…å†µå¹¶ä¸å¤š, å¦‚æœè¿™é‡Œé€šè¿‡æ‹¦æˆªæ•°ç»„çš„ç´¢å¼• åšå“åº”å¼å¤ªæµªè´¹æ€§èƒ½\n         * æ‰€ä»¥ vueé‡‡ç”¨ å‡½æ•°åŠ«æŒçš„æ–¹æ³• é‡å†™äº† 7ä¸ªèƒ½æ”¹å˜æ•°ç»„æœ¬èº«çš„æ–¹æ³•\n         * è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯ å¯¹è±¡ or æ•°ç»„\n         * åˆ©ç”¨åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾çš„ç‰¹æ€§,ä½¿å¾—æ•°ç»„æ”¹å˜çš„æ–¹æ³•ä»arrayMethodsä¸­å–åˆ°\n         */\n        if (Array.isArray(data)) {\n            data.__proto__ = arrayMethods;\n            this.observeArray(data)\n        } else {\n            this.walk(data)\n        }\n    }\n    /**\n     * æ— è®ºæ•°ç»„è¿˜æ˜¯å¯¹è±¡, éƒ½è¦éå†å…¶ä¸­çš„æ¯ä¸€é¡¹ åšå“åº”å¼å¤„ç†\n     */\n    observeArray(data) {\n        for (let i = 0; i < data.length; i++) {\n            observe(data[i]);\n        }\n    }\n    walk(data) {\n        Object.keys(data).forEach((key) => {\n            defineReactive(data, key, data[key])\n        })\n    }\n\n}\n\n/**\n * vue2.0 æœ‰æ€§èƒ½é—®é¢˜: é€’å½’é‡å†™get set æ•°æ®åµŒå¥—å¾ˆå¤§çš„è¯ æ€§èƒ½å¾ˆå·®. vue3 ä½¿ç”¨proxyå¾—åˆ°ä¼˜åŒ–ğŸ‚\n * \n */\n\nfunction defineReactive(data, key, value) {\n    observe(value) // valueå¯èƒ½è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ é€’å½’å¾ªç¯æ£€æµ‹ä¸€ä¸‹\n    Object.defineProperty(data, key, {\n        get() {\n            console.log('get----');\n            return value\n        },\n        set(newVal) {\n            if (newVal === value) return\n            observe(newVal)\n            value = newVal\n        }\n    })\n}\n\n\nexport function observe(data) {\n    // å¦‚æœä¸æ˜¯å¯¹è±¡ å°±ä¸ç”¨åšå“åº”å¼å¤„ç†\n    if (isObject(data)) {\n        return;\n    }\n    // å¦‚æœæœ‰__ob__å±æ€§    è¡¨ç¤ºè§‚æµ‹è¿‡ ä¹Ÿç›´æ¥è·³å‡º\n    if (data.__ob__ instanceof Observe) {\n        return;\n    }\n    // è¿”å›ä¸€ä¸ªobserveå®ä¾‹, è§‚æµ‹çš„æ ¸å¿ƒä»£ç åœ¨è¿™é‡Œ, ä¸€ä¸ªå¯¹è±¡ å¯¹åº”ä¸€ä¸ªobå®ä¾‹ \n    return new Observe(data)\n}","import { observe } from './observer/index'\nexport function initState(vm) {\n    const opts = vm.$options\n\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.methods) {\n        initMethod(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n\n    function initProps(vm) {\n\n    }\n    function initMethod(vm) {\n\n    }\n    function initData(vm) {\n        // è¿™é‡Œå°±æ˜¯å¦‚ä½•åšæ•°æ®å“åº”å¼çš„æºç ,é¦–å…ˆæ‹¿åˆ°ç”¨æˆ·ä¼ å…¥çš„æ•°æ®\n        let data = vm.$options.data;\n\n        if (typeof data === 'function') {\n            data = vm._data = data.call(vm)\n        } else {\n            data = vm._data = data\n        }\n\n        // æŠŠæ•°æ®ä»£ç†åˆ°vmå®ä¾‹ä¸Š, æ–¹ä¾¿å–çš„æ—¶å€™ç›´æ¥å¯ä»¥ vm.msg\n        for (const key in data) {\n            if (data.hasOwnProperty(key)) {\n                proxy(vm, '_data', key)                \n            }\n        }\n        // è§‚æµ‹æ•°æ®\n        observe(data)\n    }\n\n    function proxy(target, property, key){\n        Object.defineProperty(target, key, {\n            get(){\n                return target[property][key]\n            },\n            set(newVal){\n                target[property][key] = newVal\n            }\n        })\n    }\n}\n","import { initState } from './state'\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n\n        const vm = this;\n        // Vue å†…çš„$options å°±æ˜¯ç”¨æˆ·ä¼ å…¥çš„æ‰€æœ‰å‚æ•°\n        vm.$options = options\n\n        // åˆå§‹åŒ–çŠ¶æ€\n        initState(vm)\n\n    }\n}","/**\n * vueä½¿ç”¨çš„æ˜¯rollupæ‰“åŒ… å®ƒçš„ç‰¹ç‚¹æ˜¯æŠŠå¤šä¸ªå°æ¨¡å— ç»„åˆæˆå¤æ‚çš„é€»è¾‘\n * rollupæ›´ä¸“æ³¨äºæ‰“åŒ…javascriptç±»åº“\n * å¼€å‘åº”ç”¨çš„æ—¶å€™æ›´æ¨èç”¨webpack, å¼€å‘åº“æ—¶ç”¨rollup\n * @param {*} options \n */\n\nimport {initMixin} from './init'\n\nfunction Vue(options) {\n    // å†…éƒ¨è¦è¿›è¡Œåˆå§‹åŒ–æ“ä½œ\n    this._init(options)\n}\n\n// ç”±äºç»„ä»¶åˆå§‹åŒ– ä¼šæœ‰å¾ˆå¤šæ–¹æ³• åœ¨è¿™é‡Œå†™ä¸€å † Vue.prototype.methods ä¸ä¼˜é›… \n// æ‰€ä»¥ä½¿ç”¨æ··å…¥ æ›´å¥½ é€šè¿‡mixinå¼•å…¥\n\n// åœ¨åŸå‹ä¸Šæ·»åŠ å±æ€§æˆ–æ–¹æ³• \ninitMixin(Vue)\n\n\n\nexport default Vue"],"names":["oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","ob","__ob__","args","result","apply","inserted","slice","observeArray","isObject","obj","Observe","data","defineProperty","enumerable","configurable","value","isArray","__proto__","walk","i","length","observe","keys","key","defineReactive","get","console","log","set","newVal","initState","vm","opts","$options","props","initData","_data","call","hasOwnProperty","proxy","target","property","initMixin","Vue","_init","options"],"mappings":"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"}